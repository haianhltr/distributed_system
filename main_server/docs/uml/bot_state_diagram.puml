@startuml Bot State Diagram

[*] --> Unregistered : Bot instance created

state Unregistered {
    [*] --> ReadyToRegister
    ReadyToRegister --> Registered : Bot calls /bots/register
}

state Registered {
    [*] --> Idle
    Idle --> Busy : Bot claims job
    Idle --> Down : Bot stops sending heartbeats
    Idle --> Deleted : Admin deletes bot
}

state Busy {
    [*] --> Processing
    Processing --> Idle : Job completed/failed
    Processing --> Down : Bot crashes during processing
    Processing --> Idle : Bot reset by admin
}

state Down {
    [*] --> HeartbeatTimeout
    HeartbeatTimeout --> Idle : Bot reconnects
    HeartbeatTimeout --> Deleted : Cleanup service removes bot
}

state Deleted {
    [*] --> MarkedForDeletion
    MarkedForDeletion --> [*] : Cleanup service removes records
}

note right of Unregistered
  Bot exists but not
  known to system
end note

note right of Registered
  Bot is registered and
  can claim jobs
end note

note right of Idle
  Bot is available
  for job assignment
end note

note right of Busy
  Bot has claimed a job
  and is processing it
end note

note right of Down
  Bot has stopped
  responding to heartbeats
end note

note right of Deleted
  Bot marked for removal
  from system
end note

' Heartbeat monitoring
note bottom of Registered
  Bot must send heartbeat
  every 2 minutes to
  maintain active status
end note

note bottom of Busy
  Bot continues sending
  heartbeats while
  processing jobs
end note

@enduml
